<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>polyfit.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BigFloat.html">BigFloat</a><ul class='methods'><li data-type='method'><a href="BigFloat.html#abs">abs</a></li><li data-type='method'><a href="BigFloat.html#acos">acos</a></li><li data-type='method'><a href="BigFloat.html#add">add</a></li><li data-type='method'><a href="BigFloat.html#and">and</a></li><li data-type='method'><a href="BigFloat.html#asin">asin</a></li><li data-type='method'><a href="BigFloat.html#atan">atan</a></li><li data-type='method'><a href="BigFloat.html#atan2">atan2</a></li><li data-type='method'><a href="BigFloat.html#calc">calc</a></li><li data-type='method'><a href="BigFloat.html#calc2">calc2</a></li><li data-type='method'><a href="BigFloat.html#callFunc">callFunc</a></li><li data-type='method'><a href="BigFloat.html#ceil">ceil</a></li><li data-type='method'><a href="BigFloat.html#checkoprand">checkoprand</a></li><li data-type='method'><a href="BigFloat.html#checkstatus">checkstatus</a></li><li data-type='method'><a href="BigFloat.html#clone">clone</a></li><li data-type='method'><a href="BigFloat.html#cmp">cmp</a></li><li data-type='method'><a href="BigFloat.html#copy">copy</a></li><li data-type='method'><a href="BigFloat.html#cos">cos</a></li><li data-type='method'><a href="BigFloat.html#dispose">dispose</a></li><li data-type='method'><a href="BigFloat.html#div">div</a></li><li data-type='method'><a href="BigFloat.html#equals">equals</a></li><li data-type='method'><a href="BigFloat.html#exp">exp</a></li><li data-type='method'><a href="BigFloat.html#f64">f64</a></li><li data-type='method'><a href="BigFloat.html#floor">floor</a></li><li data-type='method'><a href="BigFloat.html#fpround">fpround</a></li><li data-type='method'><a href="BigFloat.html#fromNumber">fromNumber</a></li><li data-type='method'><a href="BigFloat.html#getEpsilon">getEpsilon</a></li><li data-type='method'><a href="BigFloat.html#geth">geth</a></li><li data-type='method'><a href="BigFloat.html#isAlmostZero">isAlmostZero</a></li><li data-type='method'><a href="BigFloat.html#isExactZero">isExactZero</a></li><li data-type='method'><a href="BigFloat.html#isFinit">isFinit</a></li><li data-type='method'><a href="BigFloat.html#isInExact">isInExact</a></li><li data-type='method'><a href="BigFloat.html#isNaN">isNaN</a></li><li data-type='method'><a href="BigFloat.html#isZero">isZero</a></li><li data-type='method'><a href="BigFloat.html#log">log</a></li><li data-type='method'><a href="BigFloat.html#mod">mod</a></li><li data-type='method'><a href="BigFloat.html#mul">mul</a></li><li data-type='method'><a href="BigFloat.html#neg">neg</a></li><li data-type='method'><a href="BigFloat.html#operatorEqual">operatorEqual</a></li><li data-type='method'><a href="BigFloat.html#operatorGreater">operatorGreater</a></li><li data-type='method'><a href="BigFloat.html#operatorGreaterEqual">operatorGreaterEqual</a></li><li data-type='method'><a href="BigFloat.html#operatorLess">operatorLess</a></li><li data-type='method'><a href="BigFloat.html#operatorLessEqual">operatorLessEqual</a></li><li data-type='method'><a href="BigFloat.html#operatorNotEqual">operatorNotEqual</a></li><li data-type='method'><a href="BigFloat.html#or">or</a></li><li data-type='method'><a href="BigFloat.html#pow">pow</a></li><li data-type='method'><a href="BigFloat.html#rem">rem</a></li><li data-type='method'><a href="BigFloat.html#round">round</a></li><li data-type='method'><a href="BigFloat.html#setEPSILON">setEPSILON</a></li><li data-type='method'><a href="BigFloat.html#setLOG2">setLOG2</a></li><li data-type='method'><a href="BigFloat.html#setMAX_VALUE">setMAX_VALUE</a></li><li data-type='method'><a href="BigFloat.html#setMIN_VALUE">setMIN_VALUE</a></li><li data-type='method'><a href="BigFloat.html#setPI">setPI</a></li><li data-type='method'><a href="BigFloat.html#setabs">setabs</a></li><li data-type='method'><a href="BigFloat.html#setacos">setacos</a></li><li data-type='method'><a href="BigFloat.html#setadd">setadd</a></li><li data-type='method'><a href="BigFloat.html#setand">setand</a></li><li data-type='method'><a href="BigFloat.html#setasin">setasin</a></li><li data-type='method'><a href="BigFloat.html#setatan">setatan</a></li><li data-type='method'><a href="BigFloat.html#setatan2">setatan2</a></li><li data-type='method'><a href="BigFloat.html#setceil">setceil</a></li><li data-type='method'><a href="BigFloat.html#setcos">setcos</a></li><li data-type='method'><a href="BigFloat.html#setdiv">setdiv</a></li><li data-type='method'><a href="BigFloat.html#setexp">setexp</a></li><li data-type='method'><a href="BigFloat.html#setfloor">setfloor</a></li><li data-type='method'><a href="BigFloat.html#setfpround">setfpround</a></li><li data-type='method'><a href="BigFloat.html#setlog">setlog</a></li><li data-type='method'><a href="BigFloat.html#setmod">setmod</a></li><li data-type='method'><a href="BigFloat.html#setmul">setmul</a></li><li data-type='method'><a href="BigFloat.html#setneg">setneg</a></li><li data-type='method'><a href="BigFloat.html#setor">setor</a></li><li data-type='method'><a href="BigFloat.html#setpow">setpow</a></li><li data-type='method'><a href="BigFloat.html#setrem">setrem</a></li><li data-type='method'><a href="BigFloat.html#setround">setround</a></li><li data-type='method'><a href="BigFloat.html#setsign">setsign</a></li><li data-type='method'><a href="BigFloat.html#setsin">setsin</a></li><li data-type='method'><a href="BigFloat.html#setsqrt">setsqrt</a></li><li data-type='method'><a href="BigFloat.html#setsub">setsub</a></li><li data-type='method'><a href="BigFloat.html#settan">settan</a></li><li data-type='method'><a href="BigFloat.html#settrunc">settrunc</a></li><li data-type='method'><a href="BigFloat.html#setxor">setxor</a></li><li data-type='method'><a href="BigFloat.html#sign">sign</a></li><li data-type='method'><a href="BigFloat.html#sin">sin</a></li><li data-type='method'><a href="BigFloat.html#sqrt">sqrt</a></li><li data-type='method'><a href="BigFloat.html#sub">sub</a></li><li data-type='method'><a href="BigFloat.html#tan">tan</a></li><li data-type='method'><a href="BigFloat.html#toBigInt">toBigInt</a></li><li data-type='method'><a href="BigFloat.html#toComplex">toComplex</a></li><li data-type='method'><a href="BigFloat.html#toFixed">toFixed</a></li><li data-type='method'><a href="BigFloat.html#toNumber">toNumber</a></li><li data-type='method'><a href="BigFloat.html#toString">toString</a></li><li data-type='method'><a href="BigFloat.html#toUint8Array">toUint8Array</a></li><li data-type='method'><a href="BigFloat.html#trunc">trunc</a></li><li data-type='method'><a href="BigFloat.html#visit">visit</a></li><li data-type='method'><a href="BigFloat.html#wraptypeh">wraptypeh</a></li><li data-type='method'><a href="BigFloat.html#xor">xor</a></li><li data-type='method'><a href="BigFloat.html#.fromString">fromString</a></li></ul></li><li><a href="BigFloat_BigFloat.html">BigFloat</a></li><li><a href="BigFraction.html">BigFraction</a><ul class='methods'><li data-type='method'><a href="BigFraction.html#abs">abs</a></li><li data-type='method'><a href="BigFraction.html#acos">acos</a></li><li data-type='method'><a href="BigFraction.html#acosh">acosh</a></li><li data-type='method'><a href="BigFraction.html#add">add</a></li><li data-type='method'><a href="BigFraction.html#asin">asin</a></li><li data-type='method'><a href="BigFraction.html#asinh">asinh</a></li><li data-type='method'><a href="BigFraction.html#atan">atan</a></li><li data-type='method'><a href="BigFraction.html#atanh">atanh</a></li><li data-type='method'><a href="BigFraction.html#cmp">cmp</a></li><li data-type='method'><a href="BigFraction.html#cos">cos</a></li><li data-type='method'><a href="BigFraction.html#cosh">cosh</a></li><li data-type='method'><a href="BigFraction.html#div">div</a></li><li data-type='method'><a href="BigFraction.html#equals">equals</a></li><li data-type='method'><a href="BigFraction.html#exp">exp</a></li><li data-type='method'><a href="BigFraction.html#floor">floor</a></li><li data-type='method'><a href="BigFraction.html#isAlmostZero">isAlmostZero</a></li><li data-type='method'><a href="BigFraction.html#isNaN">isNaN</a></li><li data-type='method'><a href="BigFraction.html#isZero">isZero</a></li><li data-type='method'><a href="BigFraction.html#log">log</a></li><li data-type='method'><a href="BigFraction.html#mul">mul</a></li><li data-type='method'><a href="BigFraction.html#neg">neg</a></li><li data-type='method'><a href="BigFraction.html#operatorAdd">operatorAdd</a></li><li data-type='method'><a href="BigFraction.html#operatorDiv">operatorDiv</a></li><li data-type='method'><a href="BigFraction.html#operatorEqual">operatorEqual</a></li><li data-type='method'><a href="BigFraction.html#operatorGreater">operatorGreater</a></li><li data-type='method'><a href="BigFraction.html#operatorGreaterEqual">operatorGreaterEqual</a></li><li data-type='method'><a href="BigFraction.html#operatorLess">operatorLess</a></li><li data-type='method'><a href="BigFraction.html#operatorLessEqual">operatorLessEqual</a></li><li data-type='method'><a href="BigFraction.html#operatorMul">operatorMul</a></li><li data-type='method'><a href="BigFraction.html#operatorNeg">operatorNeg</a></li><li data-type='method'><a href="BigFraction.html#operatorNotEqual">operatorNotEqual</a></li><li data-type='method'><a href="BigFraction.html#operatorPow">operatorPow</a></li><li data-type='method'><a href="BigFraction.html#operatorSub">operatorSub</a></li><li data-type='method'><a href="BigFraction.html#pow">pow</a></li><li data-type='method'><a href="BigFraction.html#sin">sin</a></li><li data-type='method'><a href="BigFraction.html#sinh">sinh</a></li><li data-type='method'><a href="BigFraction.html#sqrt">sqrt</a></li><li data-type='method'><a href="BigFraction.html#sub">sub</a></li><li data-type='method'><a href="BigFraction.html#tan">tan</a></li><li data-type='method'><a href="BigFraction.html#tanh">tanh</a></li><li data-type='method'><a href="BigFraction.html#toBigFloat">toBigFloat</a></li><li data-type='method'><a href="BigFraction.html#toNumber">toNumber</a></li><li data-type='method'><a href="BigFraction.html#toString">toString</a></li><li data-type='method'><a href="BigFraction.html#.fromString">fromString</a></li></ul></li><li><a href="BigFraction_BigFraction.html">BigFraction</a></li><li><a href="Complex.html">Complex</a><ul class='methods'><li data-type='method'><a href="Complex.html#abs">abs</a></li><li data-type='method'><a href="Complex.html#acos">acos</a></li><li data-type='method'><a href="Complex.html#acosh">acosh</a></li><li data-type='method'><a href="Complex.html#add">add</a></li><li data-type='method'><a href="Complex.html#arg">arg</a></li><li data-type='method'><a href="Complex.html#asin">asin</a></li><li data-type='method'><a href="Complex.html#asinh">asinh</a></li><li data-type='method'><a href="Complex.html#atan">atan</a></li><li data-type='method'><a href="Complex.html#atanh">atanh</a></li><li data-type='method'><a href="Complex.html#conj">conj</a></li><li data-type='method'><a href="Complex.html#cos">cos</a></li><li data-type='method'><a href="Complex.html#cosh">cosh</a></li><li data-type='method'><a href="Complex.html#div">div</a></li><li data-type='method'><a href="Complex.html#equals">equals</a></li><li data-type='method'><a href="Complex.html#exp">exp</a></li><li data-type='method'><a href="Complex.html#isAlmostZero">isAlmostZero</a></li><li data-type='method'><a href="Complex.html#isZero">isZero</a></li><li data-type='method'><a href="Complex.html#log">log</a></li><li data-type='method'><a href="Complex.html#mul">mul</a></li><li data-type='method'><a href="Complex.html#neg">neg</a></li><li data-type='method'><a href="Complex.html#pow">pow</a></li><li data-type='method'><a href="Complex.html#sin">sin</a></li><li data-type='method'><a href="Complex.html#sinh">sinh</a></li><li data-type='method'><a href="Complex.html#sqrt">sqrt</a></li><li data-type='method'><a href="Complex.html#sub">sub</a></li><li data-type='method'><a href="Complex.html#tan">tan</a></li><li data-type='method'><a href="Complex.html#tanh">tanh</a></li><li data-type='method'><a href="Complex.html#toString">toString</a></li><li data-type='method'><a href="Complex.html#.fromPolar">fromPolar</a></li><li data-type='method'><a href="Complex.html#.fromString">fromString</a></li></ul></li><li><a href="Poly.html">Poly</a><ul class='methods'><li data-type='method'><a href="Poly.html#acos">acos</a></li><li data-type='method'><a href="Poly.html#add">add</a></li><li data-type='method'><a href="Poly.html#asin">asin</a></li><li data-type='method'><a href="Poly.html#atan">atan</a></li><li data-type='method'><a href="Poly.html#cos">cos</a></li><li data-type='method'><a href="Poly.html#degree">degree</a></li><li data-type='method'><a href="Poly.html#deriv">deriv</a></li><li data-type='method'><a href="Poly.html#div">div</a></li><li data-type='method'><a href="Poly.html#equals">equals</a></li><li data-type='method'><a href="Poly.html#eval">eval</a></li><li data-type='method'><a href="Poly.html#exp">exp</a></li><li data-type='method'><a href="Poly.html#integ">integ</a></li><li data-type='method'><a href="Poly.html#log">log</a></li><li data-type='method'><a href="Poly.html#mul">mul</a></li><li data-type='method'><a href="Poly.html#neg">neg</a></li><li data-type='method'><a href="Poly.html#operatorAdd">operatorAdd</a></li><li data-type='method'><a href="Poly.html#operatorDiv">operatorDiv</a></li><li data-type='method'><a href="Poly.html#operatorMul">operatorMul</a></li><li data-type='method'><a href="Poly.html#operatorNeg">operatorNeg</a></li><li data-type='method'><a href="Poly.html#operatorPow">operatorPow</a></li><li data-type='method'><a href="Poly.html#operatorSub">operatorSub</a></li><li data-type='method'><a href="Poly.html#pow">pow</a></li><li data-type='method'><a href="Poly.html#powSeries">powSeries</a></li><li data-type='method'><a href="Poly.html#sin">sin</a></li><li data-type='method'><a href="Poly.html#sub">sub</a></li><li data-type='method'><a href="Poly.html#tan">tan</a></li><li data-type='method'><a href="Poly.html#toString">toString</a></li><li data-type='method'><a href="Poly.html#valuation">valuation</a></li><li data-type='method'><a href="Poly.html#.O">O</a></li><li data-type='method'><a href="Poly.html#.X">X</a></li></ul></li><li><a href="Scalar.html">Scalar</a><ul class='methods'><li data-type='method'><a href="Scalar.html#abs">abs</a></li><li data-type='method'><a href="Scalar.html#acos">acos</a></li><li data-type='method'><a href="Scalar.html#acosh">acosh</a></li><li data-type='method'><a href="Scalar.html#add">add</a></li><li data-type='method'><a href="Scalar.html#asin">asin</a></li><li data-type='method'><a href="Scalar.html#asinh">asinh</a></li><li data-type='method'><a href="Scalar.html#atan">atan</a></li><li data-type='method'><a href="Scalar.html#atanh">atanh</a></li><li data-type='method'><a href="Scalar.html#cmp">cmp</a></li><li data-type='method'><a href="Scalar.html#cos">cos</a></li><li data-type='method'><a href="Scalar.html#cosh">cosh</a></li><li data-type='method'><a href="Scalar.html#div">div</a></li><li data-type='method'><a href="Scalar.html#equals">equals</a></li><li data-type='method'><a href="Scalar.html#exp">exp</a></li><li data-type='method'><a href="Scalar.html#isAlmostZero">isAlmostZero</a></li><li data-type='method'><a href="Scalar.html#isZero">isZero</a></li><li data-type='method'><a href="Scalar.html#log">log</a></li><li data-type='method'><a href="Scalar.html#mul">mul</a></li><li data-type='method'><a href="Scalar.html#neg">neg</a></li><li data-type='method'><a href="Scalar.html#operatorAdd">operatorAdd</a></li><li data-type='method'><a href="Scalar.html#operatorDiv">operatorDiv</a></li><li data-type='method'><a href="Scalar.html#operatorMul">operatorMul</a></li><li data-type='method'><a href="Scalar.html#operatorNeg">operatorNeg</a></li><li data-type='method'><a href="Scalar.html#operatorPow">operatorPow</a></li><li data-type='method'><a href="Scalar.html#operatorSub">operatorSub</a></li><li data-type='method'><a href="Scalar.html#pow">pow</a></li><li data-type='method'><a href="Scalar.html#sin">sin</a></li><li data-type='method'><a href="Scalar.html#sinh">sinh</a></li><li data-type='method'><a href="Scalar.html#sqrt">sqrt</a></li><li data-type='method'><a href="Scalar.html#sub">sub</a></li><li data-type='method'><a href="Scalar.html#tan">tan</a></li><li data-type='method'><a href="Scalar.html#tanh">tanh</a></li><li data-type='method'><a href="Scalar.html#toString">toString</a></li><li data-type='method'><a href="Scalar.html#.fromString">fromString</a></li><li data-type='method'><a href="Scalar.html#.getLevel">getLevel</a></li><li data-type='method'><a href="Scalar.html#.promote">promote</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#E">E</a></li><li><a href="global.html#Flags">Flags</a></li><li><a href="global.html#O">O</a></li><li><a href="global.html#PI">PI</a></li><li><a href="global.html#X">X</a></li><li><a href="global.html#abs">abs</a></li><li><a href="global.html#acos">acos</a></li><li><a href="global.html#asin">asin</a></li><li><a href="global.html#atan">atan</a></li><li><a href="global.html#atan2">atan2</a></li><li><a href="global.html#bf">bf</a></li><li><a href="global.html#bigIntSqrt">bigIntSqrt</a></li><li><a href="global.html#ceil">ceil</a></li><li><a href="global.html#complex">complex</a></li><li><a href="global.html#cos">cos</a></li><li><a href="global.html#decimal_precision">decimal_precision</a></li><li><a href="global.html#exp">exp</a></li><li><a href="global.html#floor">floor</a></li><li><a href="global.html#fminbnd">fminbnd</a></li><li><a href="global.html#formatDecimal">formatDecimal</a></li><li><a href="global.html#fpround">fpround</a></li><li><a href="global.html#frac">frac</a></li><li><a href="global.html#fromDouble">fromDouble</a></li><li><a href="global.html#fzero">fzero</a></li><li><a href="global.html#gc_ele_limit">gc_ele_limit</a></li><li><a href="global.html#gcd">gcd</a></li><li><a href="global.html#globalFlag">globalFlag</a></li><li><a href="global.html#half">half</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#is_ready">is_ready</a></li><li><a href="global.html#libbf">libbf</a></li><li><a href="global.html#log">log</a></li><li><a href="global.html#max">max</a></li><li><a href="global.html#minus_one">minus_one</a></li><li><a href="global.html#neg">neg</a></li><li><a href="global.html#ode45">ode45</a></li><li><a href="global.html#one">one</a></li><li><a href="global.html#poly">poly</a></li><li><a href="global.html#polyStr">polyStr</a></li><li><a href="global.html#polyfit">polyfit</a></li><li><a href="global.html#polyval">polyval</a></li><li><a href="global.html#pop_precision">pop_precision</a></li><li><a href="global.html#pow">pow</a></li><li><a href="global.html#precision">precision</a></li><li><a href="global.html#push_decimal_precision">push_decimal_precision</a></li><li><a href="global.html#push_precision">push_precision</a></li><li><a href="global.html#romberg">romberg</a></li><li><a href="global.html#roots">roots</a></li><li><a href="global.html#round">round</a></li><li><a href="global.html#scalar">scalar</a></li><li><a href="global.html#setGlobalFlag">setGlobalFlag</a></li><li><a href="global.html#setPrecision">setPrecision</a></li><li><a href="global.html#setThrowExceptionOnInvalidOp">setThrowExceptionOnInvalidOp</a></li><li><a href="global.html#set_gc_ele_limit">set_gc_ele_limit</a></li><li><a href="global.html#sign">sign</a></li><li><a href="global.html#sin">sin</a></li><li><a href="global.html#solveLinearSystem">solveLinearSystem</a></li><li><a href="global.html#sqrt">sqrt</a></li><li><a href="global.html#tan">tan</a></li><li><a href="global.html#three">three</a></li><li><a href="global.html#throwExceptionOnInvalidOp">throwExceptionOnInvalidOp</a></li><li><a href="global.html#trunc">trunc</a></li><li><a href="global.html#two">two</a></li><li><a href="global.html#zero">zero</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">polyfit.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import * as bfjs from "./bf.js";

/**
 * High-precision Polynomial Curve Fitting using Least Squares Method.
 *
 * Finds the coefficients of a polynomial p(x) of degree n that fits the data, 
 * minimizing the sum of the squared errors.
 *
 * Coefficients are returned in descending powers (MATLAB style):
 * p(x) = c[0]*x^n + c[1]*x^(n-1) + ... + c[n-1]*x + c[n]
 *
 * @param {Array&lt;number|string|BigFloat>} x - Array of x-coordinates.
 * @param {Array&lt;number|string|BigFloat>} y - Array of y-coordinates.
 * @param {number} order - The degree of the polynomial to fit (n).
 *
 * @param {Object} [info={}] - Configuration and Status object.
 * @param {number} [info.max_time=60000] - Maximum execution time in milliseconds.
 * @param {boolean} [info.debug] - Enable debug logging.
 *
 *        // --- Output Status Properties ---
 * @param {Array&lt;BigFloat>|null} info.result - Array of coefficients (descending order).
 * @param {BigFloat} info.ssr - Sum of Squared Residuals (Error).
 * @param {BigFloat} info.r_squared - Coefficient of determination (0 to 1).
 * @param {BigFloat} info.rmse - Root Mean Square Error.
 * @param {number} info.exectime - Elapsed execution time.
 * @param {Function} info.toString - Helper to format the result.
 *
 * @returns {Array&lt;BigFloat>|null} 
 *        Returns array of BigFloat coefficients if successful, null otherwise.
 */
export function polyfit(x, y, order, info = {}) {
    let max_time = info.max_time || 60000;
    let start_time = new Date().getTime();

    // 1. Input Validation and Conversion
    if (!Array.isArray(x) || !Array.isArray(y) || x.length !== y.length || x.length === 0) {
        throw new Error("Input arrays x and y must be non-empty and of equal length.");
    }
    if (order &lt; 0 || order >= x.length) {
        // Technically strict polyfit requires order &lt; N, but we'll allow order &lt;= N-1 (N points determine degree N-1)
        throw new Error("Polynomial degree must be non-negative and less than the number of data points.");
    }

    // Convert inputs to BigFloat
    const X = x.map(val => bfjs.bf(val));
    const Y = y.map(val => bfjs.bf(val));
    const N = X.length;
    const M = order + 1; // Number of coefficients

    // Initialize info object
    info.result = null;
    info.ssr = bfjs.bf(0);
    info.r_squared = bfjs.bf(0);
    info.exectime = 0;
    info.toString = function() {
        if (!this.result) return "No result";
        return `degree=${order}, 
        R^2=${this.r_squared.toString(10, 6)}, 
        SSR=${this.ssr.toString(10, 6)}, 
        exectime=${this.exectime}ms`;
    };

    // 2. Build the Normal Equations Matrix (Linear System)
    // We need to solve A * c = B, where A is (order+1)x(order+1) and B is (order+1) vector.
    // A[j][k] = Sum(x_i ^ (j+k)), B[j] = Sum(x_i^j * y_i)
    // Indices j, k go from 0 to order.

    // Pre-calculate powers of X to avoid re-computing inside the loop (Optimization)
    // powers[i][p] = X[i]^p
    const powers = new Array(N);
    const max_pow = 2 * order;
    for (let i = 0; i &lt; N; i++) {
        powers[i] = new Array(max_pow + 1);
        powers[i][0] = bfjs.bf(1); // x^0
        for (let p = 1; p &lt;= max_pow; p++) {
            powers[i][p] = powers[i][p - 1].mul(X[i]);
        }
    }

    const A = []; // LHS Matrix
    const B = []; // RHS Vector

    for (let j = 0; j &lt; M; j++) {
        const row = [];
        let sumB = bfjs.bf(0);

        for (let k = 0; k &lt; M; k++) {
            let sumA = bfjs.bf(0);
            // Sum over all data points
            for (let i = 0; i &lt; N; i++) {
                sumA = sumA.add(powers[i][j + k]);
            }
            row.push(sumA);
        }
        
        for (let i = 0; i &lt; N; i++) {
            // B[j] = sum(x_i^j * y_i)
            // powers[i][j] is x_i^j
            sumB = sumB.add(powers[i][j].mul(Y[i]));
        }

        A.push(row);
        B.push(sumB);

        // Time check
        if (new Date().getTime() - start_time > max_time) {
            info.exectime = new Date().getTime() - start_time;
            return null; // Timeout
        }
    }

    // 3. Solve Linear System A * C = B using Gaussian Elimination with Partial Pivoting
    // Result C will be [c0, c1, ..., cn] where y = c0 + c1*x + ...
    try {
        const coeffs = solveLinearSystem(A, B);

        // 4. Post-processing
        // MATLAB polyfit returns highest degree first. 
        // Our coeffs are ascending (c0 + c1*x...), so we reverse.
        info.result = coeffs.reverse(); 

        // 5. Calculate Statistics (SSR, R^2)
        // Re-evaluate polynomial at data points
        // We use the non-reversed coeffs for calculation here (c0 + c1*x...) or handle indices carefully.
        // Let's use Horner's method with the descending result we just stored.
        
        let ss_res = bfjs.bf(0); // Sum of Squared Residuals
        let sum_y = bfjs.bf(0);
        
        for(let i=0; i&lt;N; i++) sum_y = sum_y.add(Y[i]);
        const mean_y = sum_y.div(bfjs.bf(N));
        let ss_tot = bfjs.bf(0); // Total Sum of Squares

        for (let i = 0; i &lt; N; i++) {
            // Evaluate P(x)
            let y_pred = bfjs.bf(0);
            // Horner's method: result is [c_n, c_{n-1}, ..., c_0]
            for (let k = 0; k &lt; info.result.length; k++) {
                y_pred = y_pred.mul(X[i]).add(info.result[k]);
            }

            const res = Y[i].sub(y_pred);
            ss_res = ss_res.add(res.mul(res));
            
            const dev = Y[i].sub(mean_y);
            ss_tot = ss_tot.add(dev.mul(dev));
        }

        info.ssr = ss_res;
        info.rmse = ss_res.div(bfjs.bf(N)).sqrt();
        
        if (!ss_tot.isZero()) {
            info.r_squared = bfjs.bf(1).sub(ss_res.div(ss_tot));
        } else {
            info.r_squared = bfjs.bf(1); // Perfect fit (variance is 0)
        }

    } catch (e) {
        if (info.debug) console.error("Polyfit Solver Error:", e);
        info.result = null;
    }

    info.exectime = new Date().getTime() - start_time;
    return info.result;
}

/**
 * Helper: Solve Ax = b using Gaussian Elimination with Partial Pivoting
 * @param {Array&lt;Array&lt;BigFloat>>} A - Matrix (modified in place)
 * @param {Array&lt;BigFloat>} b - Vector (modified in place)
 * @returns {Array&lt;BigFloat>} x - Solution vector
 */
export function solveLinearSystem(A, b) {
    const n = A.length;
    // Deep copy to avoid modifying original A/B outside if needed, 
    // but here A/B are local to polyfit so we modify directly for speed.
    // However, A and b passed here are arrays of references to BigFloats. 
    // Operations create new BigFloats, so original matrix numbers aren't mutated, 
    // but the array structure is.

    // Forward Elimination
    for (let i = 0; i &lt; n; i++) {
        // Pivot selection
        let pivotRow = i;
        let maxVal = A[i][i].abs();
        
        for (let k = i + 1; k &lt; n; k++) {
            if (A[k][i].abs().cmp(maxVal) > 0) {
                maxVal = A[k][i].abs();
                pivotRow = k;
            }
        }

        // Swap rows
        if (pivotRow !== i) {
            [A[i], A[pivotRow]] = [A[pivotRow], A[i]];
            [b[i], b[pivotRow]] = [b[pivotRow], b[i]];
        }

        if (A[i][i].isZero()) {
            throw new Error("Matrix is singular or ill-conditioned.");
        }

        // Elimination
        for (let k = i + 1; k &lt; n; k++) {
            const factor = A[k][i].div(A[i][i]);
            b[k] = b[k].sub(factor.mul(b[i]));
            for (let j = i; j &lt; n; j++) {
                A[k][j] = A[k][j].sub(factor.mul(A[i][j]));
            }
        }
    }

    // Back Substitution
    const x = new Array(n);
    for (let i = n - 1; i >= 0; i--) {
        let sum = bfjs.bf(0);
        for (let j = i + 1; j &lt; n; j++) {
            sum = sum.add(A[i][j].mul(x[j]));
        }
        x[i] = b[i].sub(sum).div(A[i][i]);
    }

    return x;
}

/**
 * Helper: Evaluate polynomial at x (MATLAB polyval style)
 * @param {Array&lt;BigFloat>} p - Coefficients [c_n, ..., c_0]
 * @param {BigFloat|number} x 
 * @returns {BigFloat}
 */
export function polyval(p, x) {
    let xv = bfjs.bf(x);
    let y = bfjs.bf(0);
    for (let i = 0; i &lt; p.length; i++) {
        y = y.mul(xv).add(p[i]);
    }
    return y;
}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.5</a> on Mon Feb 16 2026 13:49:12 GMT+0800 (中国标准时间) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
